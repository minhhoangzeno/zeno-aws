"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[433],{4433:function(e,n,t){t.r(n),t.d(n,{default:function(){return _}});var r=t(1413),a=t(4165),i=t(3433),c=t(5861),s=t(9439),l=t(9286),d=t(7575),u=t(1752),o=t(2622),m=t(8302),f=t(6106),h=t(7309),x=t(7846),Z=t(131),p=t(1082),v=t(2791),b=t(3144),j=t(5671),N=t(1186),y=(0,b.Z)((function e(){(0,j.Z)(this,e)}));y.COMPONENT_NAME="Teams",y.fetchAll=function(){return(0,N.W)({method:N.n.GET,url:"/".concat(y.COMPONENT_NAME),params:{filter:{order:"createdAt DESC"}}})},y.fetchAllMembers=function(){return(0,N.W)({method:N.n.GET,url:"/".concat(y.COMPONENT_NAME),params:{filter:{include:"members",order:"createdAt DESC"}}})},y.create=function(e){return(0,N.W)({method:N.n.POST,url:"/".concat(y.COMPONENT_NAME),data:e})},y.put=function(e){return(0,N.W)({method:N.n.PUT,url:"/".concat(y.COMPONENT_NAME),data:e})},y.update=function(e,n){return(0,N.W)({method:N.n.PATCH,url:"/".concat(y.COMPONENT_NAME,"/").concat(e),data:n})},y.delete=function(e){return(0,N.W)({method:N.n.DELETE,url:"/".concat(y.COMPONENT_NAME,"/").concat(e)})};var T=t(4740),w=t(9555),k=t(7027),C=t(1990),E=t(177),O=t(1190),g=t(6333),I=t(1960),M=t(184),P=m.Z.Text,S=w.Z.Option;function A(e){var n=e.modalOpen,t=e.setModalOpen,l=e.team,d=x.Z.useForm(),u=(0,s.Z)(d,1)[0],o=(0,T.C)(g.U2)[0],m=(0,T.T)(),Z=(0,v.useState)([]),p=(0,s.Z)(Z,2),b=p[0],j=p[1];(0,v.useEffect)((function(){m((0,I._6)(!1)),N()}),[m]);var N=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===l||void 0===l||!l.id){e.next=5;break}return e.next=3,O.f.fetchWhereTeam(l.id).then((function(e){return j(e.data)}));case 3:e.next=7;break;case 5:return e.next=7,O.f.fetchWhereNoTeam().then((function(e){return j(e.data)}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,v.useEffect)((function(){u.setFieldsValue((0,r.Z)((0,r.Z)({},u.getFieldsValue()),{},{name:null===l||void 0===l?void 0:l.name,leaderId:null===l||void 0===l?void 0:l.leaderId}))}),[l,u]);return(0,M.jsx)(M.Fragment,{children:(0,M.jsx)(C.Z,{destroyOnClose:!0,title:null!==l&&void 0!==l&&l.id?"C\u1eadp nh\u1eadt Team":"Th\xeam Team",style:{top:20},open:n,onOk:function(){return t(!1)},onCancel:function(){return t(!1)},footer:null,forceRender:!0,children:(0,M.jsxs)(x.Z,{form:u,onFinish:function(e){void 0===e.leaderId&&(e.leaderId=null),y.put(null!==l&&void 0!==l&&l.id?(0,r.Z)((0,r.Z)({},e),{},{id:l.id}):e).then(function(){var e=(0,c.Z)((0,a.Z)().mark((function e(n){var c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===n.data.leaderId){e.next=8;break}return e.next=3,O.f.getAccountById(n.data.leaderId).then((function(e){return e.data}));case 3:c=e.sent,O.f.update(n.data.leaderId,(0,r.Z)((0,r.Z)({},c),{},{teamId:n.data.id})).then((function(e){var n;m((0,g.X4)((0,r.Z)((0,r.Z)({},o),{},{members:null===(n=o.members)||void 0===n?void 0:n.filter((function(n){return n.id!==e.data.id}))})))})),m((0,g.d$)((0,r.Z)((0,r.Z)({},n.data),{},{members:null!==l&&void 0!==l&&l.members?(0,i.Z)(l.members):[(0,r.Z)((0,r.Z)({},c),{},{teamId:n.data.id})]}))),e.next=9;break;case 8:m((0,g.d$)((0,r.Z)((0,r.Z)({},n.data),{},{members:[]})));case 9:k.ZP.success("Success!"),t(!1);case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){k.ZP.error("Error",e)}))},onFinishFailed:function(){k.ZP.error("Error!")},colon:!1,autoComplete:"off",children:[(0,M.jsx)(P,{children:"T\xean Team"}),(0,M.jsx)(x.Z.Item,{name:"name",required:!0,label:"",children:(0,M.jsx)(E.Z,{})}),(0,M.jsx)(P,{children:"Leader"}),(0,M.jsx)(x.Z.Item,{name:"leaderId",required:!0,label:"",children:(0,M.jsx)(w.Z,{style:{width:180},children:b.length>0&&b.map((function(e,n){return(0,M.jsxs)(S,{value:e.id,children:[e.name,"-",e.username]},n)}))})}),(0,M.jsxs)(f.Z,{className:"justify-end",children:[(0,M.jsx)(h.ZP,{className:"mr-4",onClick:function(){return t(!1)},children:"\u0110\xf3ng"}),(0,M.jsx)(h.ZP,{type:"primary",htmlType:"submit",children:"L\u01b0u"})]})]})})})}var W=m.Z.Title,F=m.Z.Text;function _(){var e=(0,T.C)(g.U2),n=(0,T.T)(),t=(0,v.useState)(!1),b=(0,s.Z)(t,2),j=b[0],N=b[1],w=(0,v.useState)({}),k=(0,s.Z)(w,2),C=k[0],E=k[1],I=(0,v.useState)({}),P=(0,s.Z)(I,2),S=P[0],_=P[1],D=(0,v.useState)({}),L=(0,s.Z)(D,2),X=L[0],z=L[1],U=(0,v.useState)(!1),q=(0,s.Z)(U,2),B=q[0],G=q[1],V=1/e.length*100-2;(0,v.useEffect)((function(){$()}),[n]);var $=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.f.fetchWhereNoTeam().then((function(e){return{name:"Ch\u01b0a v\xe0o team",members:e.data}}));case 2:return t=e.sent,e.next=5,y.fetchAllMembers().then((function(e){n((0,g.ae)([t].concat((0,i.Z)(e.data))))}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,c){var s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=(0,r.Z)((0,r.Z)({},C),{},{teamId:c.id?c.id:null}),!C.id||c.id===S.id){e.next=4;break}return e.next=4,O.f.update(C.id,s).then((function(){var e;n((0,g.X4)((0,r.Z)((0,r.Z)({},S),{},{leaderId:S.leaderId===C.id?null:S.leaderId,members:null===(e=S.members)||void 0===e?void 0:e.filter((function(e){return e.id!==C.id}))}))),c.members&&n((0,g.X4)((0,r.Z)((0,r.Z)({},c),{},{members:[].concat((0,i.Z)(c.members),[s])})))}));case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),R=function(){var t=(0,c.Z)((0,a.Z)().mark((function t(c){var s,l,d;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=e[0],!c.id){t.next=7;break}return l=c.members,d=[],null===l||void 0===l||l.map((function(e){return d.push((0,r.Z)((0,r.Z)({},e),{},{teamId:null}))})),t.next=7,y.delete(c.id).then((function(){n((0,g.ps)(c)),n((0,g.X4)((0,r.Z)((0,r.Z)({},s),{},{members:s.members?[].concat((0,i.Z)(s.members),d):[].concat(d)})))}));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,M.jsxs)(M.Fragment,{children:[j&&(0,M.jsx)(A,{modalOpen:j,setModalOpen:N,team:X}),(0,M.jsx)(f.Z,{children:(0,M.jsx)(W,{level:3,children:"Nh\xf3m"})}),(0,M.jsxs)(f.Z,{className:"flex justify-between",children:[(0,M.jsx)(h.ZP,{type:"primary",disabled:!B,icon:(0,M.jsx)(l.Z,{}),className:"mb-4",onClick:function(){z({}),N(!0)}}),B?(0,M.jsx)(f.Z,{children:(0,M.jsx)(h.ZP,{type:"primary",icon:(0,M.jsx)(d.Z,{style:{fontSize:"130%"}}),onClick:function(){return G(!1)}})}):(0,M.jsx)(h.ZP,{type:"primary",className:"mb-4",onClick:function(){return G(!0)},children:"Ch\u1ec9nh s\u1eeda"})]}),(0,M.jsx)("div",{className:"flex flex-row-reverse justify-around",children:e.length>0&&e.map((function(e,n){var t,r;return(0,M.jsxs)(x.Z,{disabled:!B,className:"boxs rounded-lg bg-[#dcd5d5] overflow-hidden p-2 ",style:B?{width:"".concat(V,"%")}:{width:"".concat(V,"%"),opacity:.7},onDrop:function(n){B&&H(n,e)},onDragOver:function(e){return function(e){e.preventDefault()}(e)},children:[(0,M.jsxs)("div",{className:"w-full h-[60px]  text-[15px] font-bold flex justify-between uppercase items-center gap-2",children:[(0,M.jsxs)(F,{className:"flex items-center justify-between max-w-[130px]",children:[(0,M.jsx)("div",{className:"",title:e.name,children:e.name}),(0,M.jsx)("span",{className:"ml-2 leading-[5px] p-2 rounded-[50%] bg-white",children:null===(t=e.members)||void 0===t?void 0:t.length})]}),n>0&&(0,M.jsxs)(f.Z,{children:[(0,M.jsx)(Z.Z,{title:"S\u1eeda",children:(0,M.jsx)(m.Z.Link,{disabled:!B,className:"mr-4",onClick:function(){z(e),N(!0)},children:(0,M.jsx)(u.Z,{style:{fontSize:"130%",color:"black"}})})}),(0,M.jsx)(p.Z,{title:"B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a kh\xf4ng?",onConfirm:function(){R(e)},children:(0,M.jsx)(m.Z.Link,{disabled:!B,children:(0,M.jsx)(o.Z,{style:{fontSize:"130%",color:"black"}})})})]})]}),(0,M.jsx)("div",{className:"widgets h-[400px] w-full flex justify-start items-center flex-col gap-2",children:null===(r=e.members)||void 0===r?void 0:r.map((function(n,t){return(0,M.jsxs)("div",{className:"text-[20px] rounded-[5px] bg-white h-10 min-h-10 flex flex-col justify-center items-start px-4 w-full",draggable:B,onDragStart:function(t){return function(e,n,t){E(n),_(t)}(0,n,e)},children:[(0,M.jsxs)("p",{className:"text-[15px]",children:[n.name," ",n.id===e.leaderId?"(Leader)":""]}),(0,M.jsx)("p",{className:"text-[10px]",children:n.email})]},t)}))})]},n)}))})]})}}}]);
//# sourceMappingURL=433.0c513a18.chunk.js.map